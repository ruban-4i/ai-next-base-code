# QandA (Q&A) - Route Generation Task

**Date**: 19-08-25  
**Status**: Pending Review

## 1. Route Overview

- **Route Name**: qanda (Q&A Management)
- **Purpose**: Manage Q&A questions for online test application
- **Frontend Route**: Root level `/qanda` (not sub-route)
- **Backend Integration**: Uses online test axios instance for `/onlinetest/api/qna`
- **Display Format**: Card view (not table)
- **Pagination**: Not required
- **Features**:
  - [x] List/Browse Q&A questions in card format
  - [x] View Q&A details
  - [x] Create new Q&A questions
  - [x] Edit existing Q&A questions
  - [x] Delete Q&A questions
  - [x] Search/Filter functionality

## 2. API Integration

- **API Endpoint**: `http://localhost:5000/onlinetest/api/qna` (base URL handled by online test axios instance)
- **Data Format**: Array of Q&A objects
- **Key Fields**: QUERY_ID, TOPIC_ID, QUERY, QUERY_TYPE, MARKS_PER_QUERY, MINUS_MARKS_PERC, ACTIVE, MULTI_CHOICE, LOOKUP_VALUES

## 3. Path Definitions

Add to `src/route/paths.ts`:

```typescript
qanda: {
  root: '/qanda',
  new: '/qanda/new',
  edit: (id: string) => `/qanda/${id}/edit`,
  details: (id: string) => `/qanda/${id}`,
},
```

## 4. Schema Definition

Create `src/lib/schemas/qanda-schema.ts`:

- [x] Base QandA type
- [x] QandAResponse type
- [x] QandACreate type
- [x] QandAUpdate type
- [x] QandAListResponse type
- [x] Form validation schemas
- [x] API response schemas

**Field Types**:

- QUERY_ID: string (ObjectId)
- TOPIC_ID: string (ObjectId)
- QUERY: string (long text)
- QUERY_TYPE: string (ObjectId)
- MARKS_PER_QUERY: number
- MINUS_MARKS_PERC: number
- ACTIVE: "Y" | "N" (boolean equivalent)
- MULTI_CHOICE: "Y" | "N" (boolean equivalent)
- LOOKUP_VALUES: string

## 5. Database/API Integration

Add to `src/lib/api-paths.ts`:

```typescript
QANDA_PATHS: {
  GET_ALL: '/qna',
  GET_BY_ID: (id: string) => `/qna/${id}`,
  CREATE: '/qna',
  UPDATE: (id: string) => `/qna/${id}`,
  DELETE: (id: string) => `/qna/${id}`,
},
```

Create server functions and actions:

- [x] `src/server/functions/qanda-functions.ts` (queries - uses existing online test axios instance)
- [x] `src/server/actions/qanda-actions.ts` (mutations - uses existing online test axios instance)

## 6. Card View Display Fields

**Fields to display in card format**:

- QUERY (primary content, prominent display)
- QUERY_TYPE (badge/tag format)
- MARKS_PER_QUERY (numeric display)
- MINUS_MARKS_PERC (percentage display)
- ACTIVE (status indicator/badge)
- MULTI_CHOICE (yes/no indicator)
- LOOKUP_VALUES (category/tag display)

**Fields NOT displayed in cards**:

- QUERY_ID (internal use only)
- TOPIC_ID (internal use only)

## 7. Form Fields and Components

**Create/Edit form fields**:

- [x] **TOPIC_ID** → Select dropdown (fetch from topics API)
- [x] **QUERY** → Textarea component (main question text)
- [x] **QUERY_TYPE** → Select dropdown (fetch from query types API)
- [x] **MARKS_PER_QUERY** → Number input (validation: positive number)
- [x] **MINUS_MARKS_PERC** → Number input (validation: 0-100 percentage)
- [x] **ACTIVE** → Switch/Toggle component (Y/N values)
- [x] **MULTI_CHOICE** → Switch/Toggle component (Y/N values)
- [x] **LOOKUP_VALUES** → Text input (category/tags)

## 8. Component Architecture

Create components:

- [x] `src/pages/qanda/views/qanda-list-view.tsx` (card grid layout)
- [x] `src/pages/qanda/views/qanda-details-view.tsx` (detailed question view)
- [x] `src/pages/qanda/views/qanda-create-edit-view.tsx` (form component)
- [x] `src/pages/qanda/hooks/use-qanda-cards.tsx` (card layout hook)
- [x] `src/pages/qanda/components/qanda-card.tsx` (individual card component)
- [x] `src/pages/qanda/components/qanda-search-filter.tsx` (search/filter component)

## 9. Navigation Integration

- [x] Add to main navigation menu (root level)
- [x] Navigation label: "Q&A" or "Questions"
- [x] Update navigation configuration
- [x] No breadcrumb needed (root level route)

## 10. Search/Filter Functionality

**Search capabilities**:

- [x] Text search in QUERY content
- [x] Filter by QUERY_TYPE
- [x] Filter by ACTIVE status
- [x] Filter by MULTI_CHOICE (Yes/No)
- [x] Filter by LOOKUP_VALUES (categories)
- [x] Filter by MARKS_PER_QUERY range

## 11. App Routes Structure

```
src/app/qanda/
├── page.tsx                    # List page (card view)
├── [id]/
│   ├── page.tsx               # Detail page
│   └── edit/
│       └── page.tsx           # Edit page
└── new/
    └── page.tsx               # Create page
```

## 12. File Structure

```
src/
├── lib/
│   ├── api-paths.ts (update)
│   └── schemas/
│       └── qanda-schema.ts (new)
├── pages/
│   └── qanda/
│       ├── components/
│       │   ├── qanda-card.tsx (new)
│       │   └── qanda-search-filter.tsx (new)
│       ├── hooks/
│       │   └── use-qanda-cards.tsx (new)
│       └── views/
│           ├── qanda-list-view.tsx (new)
│           ├── qanda-details-view.tsx (new)
│           └── qanda-create-edit-view.tsx (new)
├── route/
│   └── paths.ts (update)
├── server/
│   ├── actions/
│   │   └── qanda-actions.ts (new)
│   └── functions/
│       └── qanda-functions.ts (new)
└── app/
    └── qanda/
        ├── page.tsx (new)
        ├── [id]/
        │   ├── page.tsx (new)
        │   └── edit/
        │       └── page.tsx (new)
        └── new/
            └── page.tsx (new)
```

## 13. Implementation Order

1. [x] Update `src/route/paths.ts` with qanda paths (root level)
2. [x] Create schema definitions with proper field types
3. [x] Update API paths configuration
4. [x] Create server functions (queries) - uses existing online test axios instance
5. [x] Create server actions (mutations) - uses existing online test axios instance
6. [x] Create individual card component in `src/pages/qanda/components/`
7. [x] Create search/filter component in `src/pages/qanda/components/`
8. [x] Create list view component with card grid layout
9. [x] Create details view component
10. [x] Create create/edit form component
11. [x] Create card layout hooks
12. [x] Add navigation integration (root level menu)
13. [x] Test all CRUD operations
14. [x] Test search/filter functionality
15. [x] Verify path constants usage

## 14. Special Requirements

- **Card Layout**: Use responsive grid layout, not table format
- **No Pagination**: Display all Q&A questions in card format
- **Root Level Route**: Frontend route at `/qanda` (not sub-route)
- **Backend Integration**: Reuses existing online test axios instance (no new axios instance needed)
- **Y/N Values**: Convert to boolean for UI (Switch/Toggle components)
- **Search Priority**: Focus on QUERY text search and key filters
- **Mobile Responsive**: Card layout should work well on mobile devices

## 15. Validation Rules

- **QUERY**: Required, minimum 10 characters
- **MARKS_PER_QUERY**: Required, positive number, max 100
- **MINUS_MARKS_PERC**: Required, 0-100 percentage
- **TOPIC_ID**: Required, valid topic reference
- **QUERY_TYPE**: Required, valid query type reference
- **ACTIVE**: Default "Y"
- **MULTI_CHOICE**: Default "N"

## Notes

- Follow existing patterns from other online test routes
- Ensure all navigation uses path constants from `paths.ts`
- Apply consistent styling with card-based design
- Include proper error handling and loading states
- Add proper TypeScript types throughout
- Cards should have hover effects and clear visual hierarchy
- Search should be debounced for better performance

## Review Checklist

- [x] All required files identified
- [x] Card view layout instead of table confirmed
- [x] No pagination requirement noted
- [x] Implementation order makes sense
- [x] Follows existing project patterns
- [x] Navigation paths properly defined for sub-route
- [x] Schema structure appropriate for Q&A data
- [x] Component architecture optimized for card display
- [x] Search/filter functionality scoped appropriately
- [x] Form fields and components properly mapped

---

**Instructions**: Review this task file, make any necessary adjustments, then respond with "go ahead" to begin implementation.
